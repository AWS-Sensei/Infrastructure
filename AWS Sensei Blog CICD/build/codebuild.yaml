AWSTemplateFormatVersion: '2010-09-09'
Description: CodeBuild project for building and deploying the AWS Sensei (GoHugo Framework) Blog

Parameters:
  CodeBuildRoleArn:
    Type: String
    Description: ARN of the IAM Role used by CodeBuild
  ArtifactBucketName:
    Type: String
    Description: Artifact bucket name used by CodePipeline (not required by CodeBuild but good for future extension)

Resources:
  
  HugoBuildProject:
    Type: AWS::CodeBuild::Project
    Properties:
      Name: HugoBuild
      ServiceRole: !Ref  CodeBuildRole.Arn
      Artifacts:
        Type: CODEPIPELINE
      Environment:
        ComputeType: BUILD_GENERAL1_SMALL
        Image: aws/codebuild/standard:7.0
        Type: LINUX_CONTAINER
        EnvironmentVariables:
          - Name: BUILD_ENV
            Value: production
      Source:
        Type: CODEPIPELINE  
      TimeoutInMinutes: 20  
              
Outputs:
  HugoBuildProjectName:
    Description: Name of the CodeBuild project
    Value: !Ref HugoBuildProject

  HugoBuildProjectArn:
    Description: ARN of the CodeBuild project
    Value: !GetAtt HugoBuildProject.Arn